---
phase: 05-shot-layer
plan: 04
type: execute
wave: 4
depends_on: ["05-03"]
files_modified:
  - apps/cli/cli.py
  - templates/project_template/vault/50_Scenes/SCN_Template.md
  - core/shots/__init__.py
autonomous: true

must_haves:
  truths:
    - "User can run 'gsd suggest-shots' to generate shot list"
    - "CLI reports number of shots generated"
    - "Shot list is exported to exports/shotlist.csv"
    - "Shot graph is saved to build/shotgraph.json"
    - "Scene vault template includes Shot List section"
  artifacts:
    - path: "apps/cli/cli.py"
      provides: "CLI suggest-shots command"
      contains: "def cmd_suggest_shots"
    - path: "exports/shotlist.csv"
      provides: "StudioBinder-compatible CSV export"
    - path: "build/shotgraph.json"
      provides: "Shot suggestions in JSON format"
    - path: "templates/project_template/vault/50_Scenes/SCN_Template.md"
      provides: "Scene template with Shot List section"
      contains: "## Shot List"
  key_links:
    - from: "apps/cli/cli.py"
      to: "core/shots/suggester.py"
      via: "from core.shots import ShotSuggester"
      pattern: "from core.shots import"
    - from: "apps/cli/cli.py"
      to: "core/shots/exporter.py"
      via: "from core.shots import ShotListExporter"
      pattern: "ShotListExporter"
---

<objective>
Integrate shot suggestion into CLI and update vault template for shot list display.

Purpose: Provide user-facing command for shot generation and update vault structure.
Output: CLI command, updated vault template, module exports
</objective>

<execution_context>
@/Users/bretbouchard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bretbouchard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Pattern references
@apps/cli/cli.py
@templates/project_template/vault/50_Scenes/SCN_Template.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add suggest-shots command to CLI</name>
  <files>apps/cli/cli.py</files>
  <action>
Add a new CLI command 'suggest-shots' following the pattern from cmd_validate and cmd_build.

Function cmd_suggest_shots(args: argparse.Namespace) -> int:
1. Find project root with find_project_root()
2. Check for scriptgraph.json in build/ - return error if missing
3. Print "Suggesting shots..." header
4. Import ShotSuggester from core.shots
5. Create suggester with build_path
6. Call suggest() and get result
7. Print results:
   - Scenes processed
   - Shots suggested
   - Breakdown by shot type (WS, MS, CU, etc.)
8. Get ShotList from suggester
9. Save shotgraph.json to build/
10. Import ShotListExporter
11. Create exports/ directory if needed
12. Export to exports/shotlist.csv
13. Print success message with file paths
14. Return 0 on success, 1 on failure

Error handling:
- If no scriptgraph.json, print error and suggest 'gsd build script' first
- If suggest() returns errors, print them
- Handle exceptions gracefully

Add subparser in main():
- p_shots = subparsers.add_parser("suggest-shots", help="Generate shot suggestions")
- p_shots.set_defaults(func=cmd_suggest_shots)

Also add 'shots' as an alias if desired.
</action>
  <verify>python -c "import sys; sys.argv = ['gsd', 'suggest-shots', '--help']; from apps.cli.cli import main; main()" 2>&1 | head -5</verify>
  <done>gsd suggest-shots command available and shows help</done>
</task>

<task type="auto">
  <name>Task 2: Update scene vault template with Shot List section</name>
  <files>templates/project_template/vault/50_Scenes/SCN_Template.md</files>
  <action>
Update the SCN_Template.md to include a Shot List section within the protected CONFUCIUS block.

Current protected block structure:
```markdown
<!-- CONFUCIUS:BEGIN AUTO -->
## Cast

## Beat Sheet

## Props / Wardrobe / Lighting

## Dialogue Draft

## Continuity Notes

## Issues

## Evidence

<!-- CONFUCIUS:END AUTO -->
```

Add Shot List section after Beat Sheet:
```markdown
<!-- CONFUCIUS:BEGIN AUTO -->
## Cast

## Beat Sheet

## Shot List
<!-- Shot suggestions generated by gsd suggest-shots -->
<!-- Format: [SCENE-SHOT] TYPE - Description -->

## Props / Wardrobe / Lighting

## Dialogue Draft

## Continuity Notes

## Issues

## Evidence

<!-- CONFUCIUS:END AUTO -->
```

Also add a Blocking Notes section after Shot List for future use:
```markdown
## Blocking Notes
<!-- Character staging and movement notes -->
```

The Shot List section will be auto-populated when VaultNoteWriter is extended in future updates.
</action>
  <verify>grep -c "## Shot List" /Users/bretbouchard/apps/fdx_gsd/templates/project_template/vault/50_Scenes/SCN_Template.md</verify>
  <done>Scene template contains Shot List section within protected block</done>
</task>

<task type="auto">
  <name>Task 3: Update core/shots/__init__.py with all exports</name>
  <files>core/shots/__init__.py</files>
  <action>
Update the module __init__.py to export all public classes.

Add exports:
- from .types import ShotType, CameraAngle, CameraMovement
- from .models import Shot, ShotList
- from .detector import ShotDetector
- from .exporter import ShotListExporter
- from .suggester import ShotSuggester, ShotSuggestionResult, suggest_shots

Include a comprehensive module docstring describing:
- Purpose: Shot suggestion layer for screenplay analysis
- Main classes: ShotSuggester, ShotDetector, ShotListExporter
- Data models: Shot, ShotList
- Enums: ShotType, CameraAngle, CameraMovement
- Usage: gsd suggest-shots CLI command
</action>
  <verify>python -c "from core.shots import ShotSuggester, ShotListExporter, ShotDetector, Shot, ShotList, ShotType; print('All exports OK')"</verify>
  <done>All classes importable from core.shots</done>
</task>

</tasks>

<verification>
- 'gsd suggest-shots --help' shows command usage
- Scene template has Shot List section
- All core.shots classes are exportable
</verification>

<success_criteria>
- Running 'gsd suggest-shots' generates shotgraph.json and shotlist.csv
- CLI reports shot counts by type
- Scene vault template includes Shot List section in protected block
</success_criteria>

<output>
After completion, create `.planning/phases/05-shot-layer/05-04-SUMMARY.md`
</output>
